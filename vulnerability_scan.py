import subprocess


def vulnerability_scan():
    print("\n[ Vulnerability Scanner ]")
    target = input("Enter the target IP or subnet (e.g., 192.168.1.0/24): ")

    if not target:
        print("[-] No target specified. Returning to main menu.")
        return

    try:
        print("\n[!] Scanning for vulnerabilities... Please wait.")
        result = subprocess.run(
            ["nmap", "-sV", "--script=vuln", target],
            capture_output=True,
            text=True
        )
        
        filtered_output = "\n".join([
            line for line in result.stdout.splitlines()
            if not line.startswith("Nmap scan report for")
        ])

        print("\n[+] Scan Results:")
        print(filtered_output)

    except Exception as e:
        print(f"[-] Error running vulnerability scan: {e}")
